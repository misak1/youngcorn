<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>HOME - YoungCorn - The GUI App for Pickles 2.</title>

		<!-- Bootstrap -->
		<link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.css" />

		<!-- common -->
		<link rel="stylesheet" href="/common/styles/common.css" />


	<!-- local -->
	<link rel="stylesheet" href="./index_files/cont.css" />

	</head>
	<body>
		<header class="t-header">
			<div class="container">
				<h1>YoungCorn <small>The GUI App for Pickles 2.</small></h1>
			</div>
		</header>
		<div class="mainBlock container">
			<div class="contents">

	<p>ようこそ。YoungCorn へ。</p>
	<p>YoungCorn は、Pickles2 の GUI制作環境です。</p>
	<p><button class="btn btn-default" onclick="main.socketTest();return false;">疎通テスト</button></p>

	<div class="cont_project_list">
	</div>

			</div>
		</div>


		<!-- jQuery -->
		<script src="/bower_components/jquery/dist/jquery.js"></script>

		<!-- Purl (URL Parser) -->
		<script src="/bower_components/purl/purl.js"></script>

		<!-- Bootstrap -->
		<script src="/bower_components/bootstrap/dist/js/bootstrap.js"></script>

		<!-- Twig -->
		<script src="/bower_components/twig.js/twig.js"></script>

		<!-- socket.io -->
		<script src="/socket.io/socket.io.js" type="text/javascript"></script>

		<!-- common -->
		<script src="/common/main.js"></script>


	<!-- local -->
	<script src="./index_files/cont.js"></script>
	<script id="template-projectList" type="text/template">
	<a href="/project/index.html?id={{id}}" class="list-group-item">
		<h2 class="list-group-item-heading">{{data.name}}</h2>
		<p class="list-group-item-text">{{data.path}}</p>
		<button class="btn btn-default" onclick="alert('削除機能は開発中');return false;">削除する</button>
	</a>
	</script>
	<script>
		$(main.init(function(){
			main.it79.fnc({}, [
				function(it1, data){
					console.log('setup env...');
					setTimeout(function(){
						it1.next(data);
					}, 10);
				},
				function(it1, data){
					// プロジェクト一覧を取得
					main.socket.send('getProjectAll', {}, function(projects){
						data.projects = projects;
						it1.next(data);
					});
				} ,
				function(it1, data){
					// プロジェクト一覧を描画
					var tpl = $('#template-projectList').html();
					var $ul = $('<div class="list-group">');
					main.it79.ary(
						data.projects,
						function(it2, row, idx){
							// console.log(row);
							var html =
								twig({data: tpl})
								.render({id: idx, data: row})
							;
							$ul.append(html);
							it2.next();
						},
						function(){
							$('.cont_project_list').html('').append($ul);
							it1.next();
						}
					);
					console.log(data);
					it1.next(data);
				} ,
				function(it1, data){
					console.log('Started!');
				}
			]);
		}));
	</script>

	</body>
</html>
